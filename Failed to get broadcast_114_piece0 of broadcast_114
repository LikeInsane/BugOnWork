There are several ways to solve this bug:
1. delete spark.cleaner.ttl:

2. spark.close():

3. encapsulate SparkContext as a method

4. remove unnecessary .repartition()

detail: https://issues.apache.org/jira/browse/SPARK-5594
